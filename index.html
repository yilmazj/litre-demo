<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Litre - True Apple Dark V62</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root { --bg: #000; --text: #fff; --card: rgba(30, 30, 32, 0.45); --border: rgba(255, 255, 255, 0.1); --subtext: #8e8e93; }
        body.light-mode { --bg: #f2f2f7; --text: #000; --card: rgba(255, 255, 255, 0.7); --border: rgba(0, 0, 0, 0.05); --subtext: #636366; }
        body { background-color: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; overflow: hidden; transition: 0.3s; }
        
        /* üçé Zero-Brown Apple Maps Filter - Tam Lacivert ve Soƒüuk Gri */
        #map, #miniMap { 
            height: 100%; width: 100%; min-height: 220px; border-radius: 2rem; z-index: 1; 
            background: #1c1c1e !important; /* Arka planƒ± Apple Dark Gray yaptƒ±k */
        }
        
        /* Kahverengiyi yok eden, maviyi parlatan sihirli filtre */
        .apple-map-layer { 
            filter: invert(100%) hue-rotate(200deg) brightness(0.95) contrast(1.1) saturate(0.6) !important; 
            transition: 0.4s; 
        }
        
        body.light-mode .apple-map-layer { filter: none !important; }
        
        .glass-card { background: var(--card); border: 0.5px solid var(--border); backdrop-filter: blur(40px) saturate(160%); border-radius: 2rem; }
        .haptic-btn { transition: 0.1s; cursor: pointer; }
        .haptic-btn:active { transform: scale(0.96); opacity: 0.8; }
        .dynamic-header { padding: 40px 18px 15px 18px; display: flex; justify-content: center; align-items: center; border-bottom: 0.5px solid var(--border); }
        .floating-dock { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 380px; height: 65px; background: var(--card); backdrop-filter: blur(45px); border: 0.5px solid var(--border); border-radius: 32px; display: flex; justify-content: space-around; align-items: center; z-index: 2000; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        .nav-item { color: var(--subtext); transition: 0.3s; position: relative; }
        .nav-item.active { color: var(--text); transform: translateY(-3px); }
        .nav-item.active::after { content: ''; position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%); width: 3px; height: 3px; background: var(--text); border-radius: 50%; }
        .custom-dot { width: 9px; height: 9px; border-radius: 50%; border: 1.5px solid #fff; box-shadow: 0 0 6px rgba(0,0,0,0.4); }
        .silver-grad { background: linear-gradient(145deg, #FFFFFF, #808080); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .picker-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(25px); z-index: 4000; display: none; align-items: flex-end; }
        .picker-container { background: var(--card); width: 100%; border-radius: 30px 30px 0 0; padding: 25px; border-top: 0.5px solid var(--border); }
    </style>
</head>
<body class="max-w-md mx-auto h-screen flex flex-col">

    <div id="app-content" class="flex flex-col h-full relative">
        <main class="flex-1 relative">
            <div id="home" class="tab-content active no-scrollbar pb-52">
                <header class="dynamic-header">
                    <div class="flex items-center gap-2">
                        <h1 class="text-2xl font-black tracking-tight">Litre</h1>
                    </div>
                </header>
                <div class="p-5 space-y-6">
                    <h1 class="text-3xl font-black silver-grad leading-none">Yakƒ±nƒ±ndakiler</h1>
                    <div onclick="showTab('maps', document.getElementById('map-nav'), true)" class="w-full h-64 glass-card relative overflow-hidden haptic-btn shadow-xl">
                        <div id="miniMap" class="apple-map-layer"></div>
                    </div>
                    <div class="space-y-4" id="stationList">
                        <div class="glass-card p-5 haptic-btn flex items-center gap-5">
                            <div class="w-12 h-12 bg-[#FFD500] rounded-2xl flex items-center justify-center shrink-0 shadow-lg"><span class="text-[#DE2128] font-black text-[8px]">SHELL</span></div>
                            <div class="flex-1"><h3 class="font-bold text-sm text-current">Shell - Kartal</h3><p class="text-[12px] font-bold text-current mt-1">Benzin: 53.92 TL</p></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="maps" class="tab-content h-full relative overflow-hidden">
                <header class="absolute top-12 left-5 right-5 z-[2001]">
                    <div class="glass-card h-14 rounded-[1.8rem] flex items-center px-6 shadow-2xl">
                        <i data-lucide="search" class="opacity-40 mr-3 text-current w-5 h-5"></i>
                        <input type="text" placeholder="ƒ∞stasyon ara..." class="bg-transparent text-md w-full outline-none text-current">
                    </div>
                </header>
                <div id="map" class="apple-map-layer"></div>
            </div>
            </main>

        <nav class="floating-dock">
            <button onclick="showTab('home', this)" class="nav-item active haptic-btn"><i data-lucide="home"></i></button>
            <button id="map-nav" onclick="showTab('maps', this, true)" class="nav-item haptic-btn"><i data-lucide="map-pin"></i></button>
            <button class="nav-item" onclick="handleScanAction()"><div class="bg-blue-600 p-4 rounded-[1.8rem] shadow-xl haptic-btn"><i data-lucide="camera" class="text-white w-6 h-6"></i></div></button>
            <button onclick="showTab('radar', this)" class="nav-item haptic-btn"><i data-lucide="zap"></i></button>
            <button onclick="showTab('profile', this)" class="nav-item haptic-btn"><i data-lucide="user"></i></button>
        </nav>
    </div>

    <script>
        lucide.createIcons();
        let leafletMap, miniMap, currentTheme = 'dark';
        
        // Bu tile layer koyu mod filtresi i√ßin en temiz sonucu verir
        const tileLayer = 'https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png';

        function updateMapDisplay(mapObj, elementId) { 
            if(!mapObj) return; 
            mapObj.eachLayer(l => { if(l instanceof L.TileLayer) mapObj.removeLayer(l); }); 
            L.tileLayer(tileLayer).addTo(mapObj); 
            
            const el = document.getElementById(elementId); 
            if(currentTheme === 'dark') { 
                el.classList.add('apple-map-layer'); 
                el.style.background = '#1c1c1e'; 
            } else { 
                el.classList.remove('apple-map-layer'); 
                el.style.background = '#ffffff'; 
            } 
        }

        function initMap() { 
            if (leafletMap) return; 
            leafletMap = L.map('map', { zoomControl: false, attributionControl: false }).setView([41.0082, 28.9784], 11); 
            updateMapDisplay(leafletMap, 'map'); 
        }

        function initMiniMap() { 
            if (miniMap) return; 
            miniMap = L.map('miniMap', { zoomControl: false, attributionControl: false, dragging: false, touchZoom: false }).setView([41.0082, 28.9784], 10); 
            updateMapDisplay(miniMap, 'miniMap'); 
        }

        function showTab(tabId, el, isMap = false) { 
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active')); 
            document.getElementById(tabId).classList.add('active'); 
            if(el) { document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active')); el.classList.add('active'); } 
            if(tabId === 'maps') { setTimeout(() => { initMap(); leafletMap.invalidateSize(); }, 300); } 
        }

        window.addEventListener('load', () => { initMiniMap(); });
    </script>
</body>
</html>