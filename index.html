<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Litre - Production V69</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <link rel="apple-touch-icon" href="https://via.placeholder.com/180/007AFF/FFFFFF?text=L">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        :root { --bg: #000; --text: #fff; --card: rgba(30, 30, 32, 0.5); --border: rgba(255, 255, 255, 0.08); }
        body { 
            background-color: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; 
            overflow: hidden; padding-top: env(safe-area-inset-top); /*  Notch Support */
            padding-bottom: env(safe-area-inset-bottom);
        }
        .tab-content { display: none; height: 100%; width: 100%; position: absolute; top: 0; left: 0; overflow-y: auto; }
        .tab-content.active { display: block; }
        .glass-card { background: var(--card); border: 0.5px solid var(--border); backdrop-filter: blur(35px) saturate(160%); border-radius: 2rem; }
        .floating-dock { 
            position: fixed; bottom: calc(25px + env(safe-area-inset-bottom)); 
            left: 50%; transform: translateX(-50%); width: 90%; max-width: 380px; height: 65px; 
            background: var(--card); backdrop-filter: blur(45px); border-radius: 32px; 
            display: flex; justify-content: space-around; align-items: center; z-index: 2000; 
        }
        .nav-item { color: #8e8e93; }
        .nav-item.active { color: #fff; }
        #map, #miniMap { height: 100%; width: 100%; min-height: 220px; border-radius: 2rem; background: #000; }
        .apple-map-layer { filter: invert(100%) hue-rotate(180deg) brightness(1.1) contrast(0.85) saturate(1.5); }
        .wheel-item { height: 44px; line-height: 44px; font-size: 16px; opacity: 0.4; transition: 0.3s; }
        .wheel-item.selected { opacity: 1; font-weight: 800; font-size: 24px; transform: scale(1.1); color: #fff; }
        .toggle-switch { width: 44px; height: 24px; background: rgba(255,255,255,0.1); border-radius: 20px; position: relative; transition: 0.3s; }
        .toggle-switch.active { background: #22c55e; }
        .toggle-knob { width: 20px; height: 20px; background: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: 0.3s; }
        .toggle-switch.active .toggle-knob { left: 22px; }
    </style>
</head>
<body class="max-w-md mx-auto h-screen">

<div id="splash" class="fixed inset-0 bg-black z-[5000] flex flex-col items-center justify-center transition-opacity duration-700">
    <svg width="80" height="100" viewBox="0 0 100 120"><defs><linearGradient id="logoSplash" x1="0%" y1="100%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#FFFFFF" /><stop offset="100%" style="stop-color:#808080" /></linearGradient></defs><path d="M50 25 C 50 25, 15 70, 15 90 A 35 35 0 0 0 85 90 C 85 70, 50 25, 50 25 Z" fill="none" stroke="url(#logoSplash)" stroke-width="12" stroke-linecap="round"/></svg>
    <h1 class="text-4xl font-black mt-3 text-white tracking-tighter">Litre</h1>
</div>

<div id="app-content" class="opacity-0 transition-opacity duration-1000 h-full relative">
    <main class="h-full relative overflow-hidden">
        <div id="home" class="tab-content active p-5 pt-14 pb-32">
            <header class="flex items-center gap-2 mb-6">
                <svg width="25" height="30" viewBox="0 0 100 120"><path d="M50 25 C 50 25, 15 70, 15 90 A 35 35 0 0 0 85 90 C 85 70, 50 25, 50 25 Z" fill="#fff"/></svg>
                <h1 class="text-2xl font-black">Litre</h1>
            </header>
            <div onclick="showTab('maps', document.getElementById('map-nav'))" class="w-full h-64 glass-card mb-8 overflow-hidden"><div id="miniMap" class="apple-map-layer"></div></div>
            <div class="space-y-4">
                <div class="glass-card p-5 flex justify-between items-center"><div><h3 class="font-bold text-sm">Shell - Anadolu</h3><p class="text-xs opacity-50">Benzin: 53.92 路 Motorin: 55.76</p></div><i data-lucide="chevron-right" class="opacity-20"></i></div>
                <div class="glass-card p-5 flex justify-between items-center"><div><h3 class="font-bold text-sm">Shell - Avrupa</h3><p class="text-xs opacity-50">Benzin: 54.07 路 Motorin: 55.91</p></div><i data-lucide="chevron-right" class="opacity-20"></i></div>
                <div class="glass-card p-5 flex justify-between items-center"><div><h3 class="font-bold text-sm">Opet - Anadolu</h3><p class="text-xs opacity-50">Benzin: 53.90 路 Motorin: 55.74</p></div><i data-lucide="chevron-right" class="opacity-20"></i></div>
                <div class="glass-card p-5 flex justify-between items-center"><div><h3 class="font-bold text-sm">Opet - Avrupa</h3><p class="text-xs opacity-50">Benzin: 54.05 路 Motorin: 55.86</p></div><i data-lucide="chevron-right" class="opacity-20"></i></div>
                <div class="glass-card p-5 flex justify-between items-center"><div><h3 class="font-bold text-sm">PO - Anadolu</h3><p class="text-xs opacity-50">Benzin: 53.92 路 Motorin: 57.16</p></div><i data-lucide="chevron-right" class="opacity-20"></i></div>
                <div class="glass-card p-5 flex justify-between items-center"><div><h3 class="font-bold text-sm">PO - Avrupa</h3><p class="text-xs opacity-50">Benzin: 53.92 路 Motorin: 57.11</p></div><i data-lucide="chevron-right" class="opacity-20"></i></div>
            </div>
        </div>

        <div id="maps" class="tab-content h-full"><div id="map" class="apple-map-layer"></div></div>

        <div id="profile" class="tab-content p-5 pt-14 pb-32">
            <div class="flex flex-col items-center mb-10"><div class="w-20 h-20 bg-zinc-800 rounded-full flex items-center justify-center text-4xl mb-3"></div><h2 class="text-2xl font-black">Volkan Y谋lmaz</h2></div>
            <div class="glass-card p-6 mb-6">
                <div class="flex justify-between text-center border-b border-white/5 pb-4 mb-4">
                    <div><p class="text-[9px] opacity-40 uppercase">Marka</p><p id="viewMarka" class="font-bold">Audi A6</p></div>
                    <div><p class="text-[9px] opacity-40 uppercase">Plaka</p><p class="font-bold">34 ABC 123</p></div>
                </div>
                <div class="grid grid-cols-2 text-center">
                    <div><p class="text-[9px] opacity-40 uppercase">Ocak Masraf谋</p><p class="text-xl font-black text-blue-500">1.755 TL</p></div>
                    <div><p class="text-[9px] opacity-40 uppercase">Ocak Litre</p><p class="text-xl font-black">32.5 L</p></div>
                </div>
            </div>
            <div class="glass-card p-2 space-y-1">
                <div onclick="openSettings()" class="p-4 flex justify-between items-center"><span class="font-bold text-sm">Uygulama Ayarlar谋</span><i data-lucide="settings" class="w-4 h-4 opacity-30"></i></div>
                <div onclick="openNotify()" class="p-4 border-t border-white/5 flex justify-between items-center"><span class="font-bold text-sm">Bildirim Ayarlar谋</span><i data-lucide="bell" class="w-4 h-4 opacity-30"></i></div>
            </div>
        </div>
    </main>

    <nav class="floating-dock">
        <button onclick="showTab('home', this)" class="nav-item active"><i data-lucide="home"></i></button>
        <button id="map-nav" onclick="showTab('maps', this)"><i data-lucide="map-pin"></i></button>
        <button class="nav-item"><div class="bg-blue-600 p-4 rounded-3xl shadow-lg"><i data-lucide="camera" class="text-white"></i></div></button>
        <button onclick="showTab('profile', this)" class="nav-item"><i data-lucide="user"></i></button>
    </nav>
</div>

<div id="notifyOverlay" class="fixed inset-0 bg-black/80 backdrop-blur-md z-[4000] hidden items-end" onclick="closeNotify()">
    <div class="glass-card w-full rounded-t-[3rem] p-8 pb-16" onclick="event.stopPropagation()">
        <h3 class="text-lg font-black mb-6">Bildirim Ayarlar谋</h3>
        <div class="space-y-6">
            <div class="flex justify-between items-center"><div><p class="font-bold text-sm">Fiyat Haberleri</p></div><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
            <div class="flex justify-between items-center"><div><p class="font-bold text-sm">Harcama Analizi</p></div><div class="toggle-switch active" onclick="this.classList.toggle('active')"><div class="toggle-knob"></div></div></div>
            <button onclick="closeNotify()" class="w-full p-4 bg-white/10 rounded-2xl font-bold mt-4">Kapat</button>
        </div>
    </div>
</div>

<script>
    lucide.createIcons();
    let leafletMap, miniMap, currentTheme = 'dark';
    
    function initMaps() {
        if (!leafletMap) {
            leafletMap = L.map('map', { zoomControl: false, attributionControl: false }).setView([41.0082, 28.9784], 11);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}{r}.png').addTo(leafletMap);
        }
        if (!miniMap) {
            miniMap = L.map('miniMap', { zoomControl: false, attributionControl: false, dragging: false, touchZoom: false }).setView([41.0082, 28.9784], 10);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}{r}.png').addTo(miniMap);
        }
    }

    function showTab(id, el) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        if (el) el.classList.add('active');
        if (id === 'maps') { setTimeout(() => { leafletMap.invalidateSize(); }, 50); }
    }

    function openNotify() { document.getElementById('notifyOverlay').style.display = 'flex'; }
    function closeNotify() { document.getElementById('notifyOverlay').style.display = 'none'; }

    window.addEventListener('load', () => {
        setTimeout(() => {
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => { 
                document.getElementById('splash').style.display = 'none';
                document.getElementById('app-content').style.opacity = '1';
                initMaps();
            }, 700);
        }, 2000);
    });

    if ('serviceWorker' in navigator) { window.addEventListener('load', () => { navigator.serviceWorker.register('sw.js'); }); }
</script>
</body>
</html>